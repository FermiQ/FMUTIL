<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FMUTIL: rootfinding Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FMUTIL
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">Fortran Miscellaneous UTILities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacerootfinding.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">rootfinding Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>RootFinding Module.  
<a href="namespacerootfinding.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacerootfinding_1_1func.html">func</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface of the function whose root needs to be computed.  <a href="interfacerootfinding_1_1func.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a6014fa3d4f56398d154b87a0890dd7dc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacerootfinding.html#a6014fa3d4f56398d154b87a0890dd7dc">polyroots</a> (c, r, error, BalanceOn)</td></tr>
<tr class="memdesc:a6014fa3d4f56398d154b87a0890dd7dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the complex roots of the given polynomial.  <a href="namespacerootfinding.html#a6014fa3d4f56398d154b87a0890dd7dc">More...</a><br /></td></tr>
<tr class="separator:a6014fa3d4f56398d154b87a0890dd7dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc853cbacd52ca42ed3a57bf03bdf1b4"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacerootfinding.html#afc853cbacd52ca42ed3a57bf03bdf1b4">root</a> (a, b, ya, yb, tol, f, x, fx, niter, error)</td></tr>
<tr class="memdesc:afc853cbacd52ca42ed3a57bf03bdf1b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine for computing the root using Brent algorithm.  <a href="namespacerootfinding.html#afc853cbacd52ca42ed3a57bf03bdf1b4">More...</a><br /></td></tr>
<tr class="separator:afc853cbacd52ca42ed3a57bf03bdf1b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a55371056b7f94455e53b60f8a508303a"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacerootfinding.html#a55371056b7f94455e53b60f8a508303a">max_iterations</a> = 50</td></tr>
<tr class="memdesc:a55371056b7f94455e53b60f8a508303a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max iterations for all the root-finding.  <a href="namespacerootfinding.html#a55371056b7f94455e53b60f8a508303a">More...</a><br /></td></tr>
<tr class="separator:a55371056b7f94455e53b60f8a508303a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>RootFinding Module. </p>
<p>This module provides functions for root-finding of polynomials by solving associated eigenvalue problems and nonlinear equations using algorithms like Brent's Algorithm. </p><dl class="section author"><dt>Author</dt><dd>Bharat Mahajan </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 07/31/2019 <br  />
 </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a6014fa3d4f56398d154b87a0890dd7dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6014fa3d4f56398d154b87a0890dd7dc">&#9670;&nbsp;</a></span>polyroots()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine rootfinding::polyroots </td>
          <td>(</td>
          <td class="paramtype">complex(wp), dimension(1:), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">complex(wp), dimension(:), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>BalanceOn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the complex roots of the given polynomial. </p>
<p>PolyRoots finds the roots of the polynomial defined by complex coefficients given in array "c" (c(1) is the highest degree coeff.). It forms the companion matrix and then solves its eigenvalues using LAPACk routines from Intel MKL library. The algorithm is same as that used by MATLAB's "roots" command. References:</p><ol type="1">
<li><a href="https://blogs.mathworks.com/cleve/2016/06/27/19-dubious-ways-to-compute-the-zeros-of-a-polynomial/">https://blogs.mathworks.com/cleve/2016/06/27/19-dubious-ways-to-compute-the-zeros-of-a-polynomial/</a></li>
<li>Math77: <a href="http://www.netlib.org/math/docpdf/ch07-01.pdf">http://www.netlib.org/math/docpdf/ch07-01.pdf</a> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Complex coefficients of the polynomial defined by p(x) = c(1)*x^n + ... + c(n)*x + c(n+1) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">r</td><td>Complex roots array </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">error</td><td>Error status returned to the user. "0" : Success, valid results in "r" "-1": Error, input coefficients array has length less than two "-2": Error, all the coefficients are zero "-3": Error, companion matrix balancing failed "-4": Error, LAPACK routine failed to compute eigenvalues </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">balanceon</td><td>If True, then the companion matrix is balanced first before finding its eigenvalues, otherwise not. Default is True. It may produce inaccurate results in case of very poorly-scaled matrices. </td></tr>
  </table>
  </dd>
</dl>
</li>
</ol>
<dl class="section remark"><dt>Remarks</dt><dd>return if input coefficient array is empty</dd>
<dd>
Return if all coefficients are zero</dd>
<dd>
Leading zeros are thrown away while the trailing zero coefficients are remembered by introducing roots at zero.</dd></dl>

<p class="definition">Definition at line <a class="el" href="rootfinding_8f90_source.html#l00066">66</a> of file <a class="el" href="rootfinding_8f90_source.html">rootfinding.f90</a>.</p>

<p class="reference">References <a class="el" href="fmutil__base_8_f90_source.html#l00047">fmutilbase::inf</a>.</p>

</div>
</div>
<a id="afc853cbacd52ca42ed3a57bf03bdf1b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc853cbacd52ca42ed3a57bf03bdf1b4">&#9670;&nbsp;</a></span>root()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine rootfinding::root </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>ya</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>yb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">procedure(<a class="el" href="interfacerootfinding_1_1func.html">func</a>)&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(out)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(out)&#160;</td>
          <td class="paramname"><em>fx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>niter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine for computing the root using Brent algorithm. </p>
<p>For details on the algorithm, see Numerical receipes in C book at <a href="https://www2.units.it/ipl/students_area/imm2/files/Numerical_Recipes.pdf">https://www2.units.it/ipl/students_area/imm2/files/Numerical_Recipes.pdf</a> </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Lower bound on the root </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Upper bound on the root </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ya</td><td>f(a) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yb</td><td>f(b) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>tolerance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">f</td><td>function </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">x</td><td>root </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fx</td><td>value at root </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">niter</td><td>no. of iterations </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">error</td><td>Error status returned to the user. "0" means root has been found. "1" means provided bounds do not contain the root, i.e., root is not bracketed. "2" means maximum number of interations reached. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rootfinding_8f90_source.html#l00208">208</a> of file <a class="el" href="rootfinding_8f90_source.html">rootfinding.f90</a>.</p>

<p class="reference">References <a class="el" href="rootfinding_8f90_source.html#l00042">max_iterations</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a55371056b7f94455e53b60f8a508303a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55371056b7f94455e53b60f8a508303a">&#9670;&nbsp;</a></span>max_iterations</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter rootfinding::max_iterations = 50</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Max iterations for all the root-finding. </p>

<p class="definition">Definition at line <a class="el" href="rootfinding_8f90_source.html#l00042">42</a> of file <a class="el" href="rootfinding_8f90_source.html">rootfinding.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="rootfinding_8f90_source.html#l00209">root()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacerootfinding.html">rootfinding</a></li>
    <li class="footer">Generated on Sun Jun 28 2020 14:09:22 for FMUTIL by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
